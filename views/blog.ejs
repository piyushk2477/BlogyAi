<!DOCTYPE html>
<html lang="en">
  <head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title><%= blog.title %></title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com"></script>

<style>
  /* Smooth Scroll */
  html { scroll-behavior: smooth; }

  /* Floating shapes animation */
  @keyframes float {
    0%   { transform: translateY(0) rotate(0deg); opacity: 0.8; }
    50%  { transform: translateY(-20px) rotate(180deg); opacity: 1; }
    100% { transform: translateY(0) rotate(360deg); opacity: 0.8; }
  }
  .shape {
    position: absolute;
    animation: float 6s ease-in-out infinite;
    opacity: 0.6;
  }
  .shape.triangle { border-left: 15px solid transparent; border-right: 15px solid transparent; border-bottom: 25px solid #ff6f61; }
  .shape.square   { width: 20px; height: 20px; background: #4A90E2; }
  .shape.circle   { width: 20px; height: 20px; border-radius: 50%; background: #50C878; }
</style>
</head>
  <body class="bg-[#fef9e7] text-gray-900 relative overflow-x-hidden">
    <%- include('./partials/nav') %>

    <!-- Animated Shapes -->
    <div class="shape triangle top-20 left-10" style="animation-delay:0s;"></div>
    <div class="shape square top-40 right-20" style="animation-delay:1s;"></div>
    <div class="shape circle top-60 left-1/2" style="animation-delay:2s;"></div>
    <div class="shape triangle bottom-20 right-10" style="animation-delay:3s;"></div>

    <!-- Blog Container -->
    <div class="container mx-auto px-4 py-10 max-w-4xl relative z-10">

      <!-- Blog Card -->
      <div class="bg-white border-2 border-black shadow-[8px_8px_0px_black] 
                  rounded-lg p-6 md:p-10 mb-10">
        
        <!-- Title -->
        <h1 class="text-3xl md:text-5xl font-bold mb-6 font-[VT323] text-center text-gray-900">
          <%= blog.title %>
        </h1>

        <!-- Cover Image -->
        <div class="mb-6">
          <img src="<%= blog.coverImageURL %>" 
               alt="<%= blog.title %>" 
               class="w-full border-2 border-black shadow-[4px_4px_0px_black] rounded-md">
        </div>

        <!-- Blog Body -->
        <div class="prose max-w-none text-lg leading-relaxed prose-headings:font-bold prose-p:mb-4">
          <%= blog.body %>
        </div>

        <!-- Author Info -->
        <div class="flex items-center gap-3 mt-8 pt-4 border-t-2 border-black">
  <img src="<%= blog.createdBy?.profileImageURL || '/default-avatar.png' %>" 
       alt="<%= blog.createdBy?.fullName || 'Unknown Author' %>" 
       class="w-12 h-12 rounded-full border-2 border-black shadow-[3px_3px_0px_black]">
  <span class="font-bold text-lg"><%= blog.createdBy?.fullName || 'Unknown Author' %></span>
</div>
      <!-- Comments Section -->
      <div class="bg-white border-2 border-black shadow-[8px_8px_0px_black] 
                  rounded-lg p-6 md:p-8">
        <h2 class="text-2xl md:text-3xl font-bold mb-6">ðŸ’¬ Comments (<%= comments.length %>)</h2>

        <!-- Add Comment -->
        <% if (locals.user) { %>
        <form action="/blog/comment/<%= blog._id %>" method="post" 
              class="mb-6 flex flex-col sm:flex-row gap-3">
          <input
            type="text"
            name="content"
            placeholder="Write your comment..."
            class="flex-grow border-2 border-black p-3 rounded-md focus:outline-none text-lg"
          />
          <button 
            type="submit" 
            class="px-6 py-3 bg-black text-white border-2 border-black 
                   shadow-[3px_3px_0px_black] hover:translate-y-1 
                   hover:shadow-[1px_1px_0px_black] transition-all text-lg">
            Add
          </button>
        </form>
        <% } else { %>
          <p class="text-gray-600 mb-6">Login to add a comment.</p>
        <% } %>

        <!-- Show Comments -->
        <div class="space-y-4">
  <% comments.forEach(comment => { %>
  <div class="flex items-start gap-3 bg-[#fafafa] border-2 border-black 
              p-4 rounded-md shadow-[4px_4px_0px_black]">
    <img src="<%= comment.createdBy?.profileImageURL || '/default-avatar.png' %>" 
         alt="<%= comment.createdBy?.fullName || 'Unknown User' %>" 
         class="w-10 h-10 rounded-full border-2 border-black">
    <div>
      <span class="font-bold"><%= comment.createdBy?.fullName || 'Unknown User' %></span>
      <p class="text-gray-700 whitespace-pre-line"><%= comment.content %></p>
    </div>
  </div>
  <% }) %>
</div>
      </div>
    </div>

    <%- include('./partials/scripts') %>
  </body>
</html>
